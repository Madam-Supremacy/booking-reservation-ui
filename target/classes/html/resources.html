<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resources - Booking System</title>

    <!-- Fonts & Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- ================= STYLES ================= -->
    <style>
        /* --- RESET & BASE --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            width: 100%;
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,.15);
        }

        /* --- HEADER --- */
        header {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        header h1 {
            color: white;
            display: flex;
            gap: 12px;
            font-size: 2rem;
        }

        nav {
            display: flex;
            gap: 12px;
        }

        nav a {
            color: white;
            text-decoration: none;
            padding: 12px 18px;
            border-radius: 10px;
            background: rgba(255,255,255,.15);
            transition: .3s;
            display: flex;
            gap: 8px;
            align-items: center;
        }

        nav a:hover { background: rgba(255,255,255,.25); }
        nav a.active { background: white; color: #4a90e2; }

        /* --- MAIN --- */
        main { padding: 40px 30px; }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .btn {
            border: none;
            padding: 14px 30px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: .3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #f87171);
            color: white;
        }

        .btn-secondary {
            background: #64748b;
            color: white;
        }

        .btn-sm {
            padding: 8px 14px;
            font-size: .85rem;
        }

        /* --- FORM --- */
        .form-container {
            display: none;
            background: #f9fafb;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 40px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px,1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        label {
            font-weight: 600;
            margin-bottom: 6px;
            display: flex;
            gap: 8px;
        }

        input, select, textarea {
            width: 100%;
            padding: 14px;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
            font-family: inherit;
        }

        textarea { resize: vertical; min-height: 100px; }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        /* --- SUMMARY --- */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px,1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            padding: 20px;
            border-radius: 14px;
            background: white;
            box-shadow: 0 10px 30px rgba(0,0,0,.08);
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .summary-icon {
            width: 55px;
            height: 55px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            background: linear-gradient(135deg, #4a90e2, #34d399);
        }

        /* --- TABLE --- */
        .table-container {
            overflow-x: auto;
            border-radius: 16px;
            box-shadow: 0 15px 40px rgba(0,0,0,.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }

        thead {
            background: linear-gradient(135deg, #4a90e2, #357abd);
            color: white;
        }

        th, td {
            padding: 16px;
            border-bottom: 1px solid #e2e8f0;
            text-align: left;
        }

        tbody tr:hover { background: #f1f5f9; }

        .resource-type {
            padding: 8px 16px;
            border-radius: 50px;
            color: white;
            font-weight: 700;
            font-size: .85rem;
        }

        .room { background: #3b82f6; }
        .equipment { background: #06b6d4; }
        .venue { background: #f59e0b; }
        .vehicle { background: #8b5cf6; }
        .other { background: #64748b; }

        /* --- MODAL --- */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 450px;
            width: 100%;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 20px;
        }

        /* --- NOTIFICATION --- */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 12px;
            color: white;
            transform: translateX(120%);
            transition: .4s;
        }

        .notification.show { transform: translateX(0); }
        .success { background: #10b981; }
        .error { background: #ef4444; }
    </style>
</head>

<body>
<div class="container">

<header>
    <h1><i class="fas fa-list"></i> Resource Management</h1>
    <nav>
        <a href="index.html"><i class="fas fa-home"></i> Home</a>
        <a href="resources.html" class="active"><i class="fas fa-list"></i> Resources</a>
        <a href="bookings.html"><i class="fas fa-book"></i> Bookings</a>
        <a href="availability.html"><i class="fas fa-check-circle"></i> Availability</a>
    </nav>
</header>

<main>

<div class="section-header">
    <h2><i class="fas fa-boxes"></i> All Resources</h2>
    <button class="btn btn-primary" onclick="showAddResourceForm()">
        <i class="fas fa-plus-circle"></i> Add New Resource
    </button>
</div>

<div class="summary-cards" id="summaryCards"></div>

<!-- FORM -->
<div id="addResourceForm" class="form-container">
    <h3 id="formTitle">Add Resource</h3>
    <form onsubmit="handleResourceForm(event)">
        <input type="hidden" id="resourceId">

        <div class="form-row">
            <div>
                <label><i class="fas fa-tag"></i> Name</label>
                <input id="resourceName" required>
            </div>
            <div>
                <label><i class="fas fa-cube"></i> Type</label>
                <select id="resourceType" required>
                    <option value="">Select</option>
                    <option>Room</option>
                    <option>Equipment</option>
                    <option>Venue</option>
                    <option>Vehicle</option>
                    <option>Other</option>
                </select>
            </div>
        </div>

        <div class="form-row">
            <div>
                <label><i class="fas fa-users"></i> Capacity</label>
                <input type="number" id="capacity" min="1" value="1">
            </div>
            <div>
                <label><i class="fas fa-map-marker-alt"></i> Location</label>
                <input id="location">
            </div>
        </div>

        <div class="form-row">
            <div>
                <label><i class="fas fa-align-left"></i> Description</label>
                <textarea id="description"></textarea>
            </div>
        </div>

        <div class="form-actions">
            <button class="btn btn-success">Save</button>
            <button type="button" class="btn btn-secondary" onclick="hideAddResourceForm()">Cancel</button>
        </div>
    </form>
</div>

<!-- TABLE -->
<div class="table-container">
<table>
    <thead>
        <tr>
            <th>ID</th><th>Name</th><th>Type</th><th>Capacity</th>
            <th>Location</th><th>Description</th><th>Actions</th>
        </tr>
    </thead>
    <tbody id="resourcesBody"></tbody>
</table>
</div>

</main>

<footer style="text-align:center;padding:20px;color:#666;">
    Booking Reservation System Â© 2026
</footer>

</div>

<!-- DELETE MODAL -->
<div id="deleteModal" class="modal">
    <div class="modal-content">
        <h3><i class="fas fa-exclamation-triangle"></i> Delete Resource</h3>
        <p id="deleteModalBody"></p>
        <div class="modal-actions">
            <button class="btn btn-danger" onclick="confirmDelete()">Delete</button>
            <button class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
        </div>
    </div>
</div>

<div id="notificationContainer"></div>

<!-- ================= SCRIPT ================= -->
<script>
let resources = [];
let isEditMode = false;
let resourceToDelete = null;

document.addEventListener('DOMContentLoaded', loadResources);

async function loadResources() {
    const res = await fetch('/api/resources');
    resources = await res.json();
    displayResources();
    updateSummaryCards();
}

function displayResources() {
    const body = document.getElementById('resourcesBody');
    body.innerHTML = resources.map(r => `
        <tr>
            <td>#${r.id}</td>
            <td>${r.name}</td>
            <td><span class="resource-type ${r.type.toLowerCase()}">${r.type}</span></td>
            <td>${r.capacity}</td>
            <td>${r.location || '-'}</td>
            <td>${r.description || '-'}</td>
            <td>
                <button class="btn btn-sm btn-warning" onclick="editResource(${r.id})">Edit</button>
                <button class="btn btn-sm btn-danger" onclick="showDeleteModal(${r.id},'${r.name}')">Delete</button>
            </td>
        </tr>
    `).join('');
}

function updateSummaryCards() {
    const el = document.getElementById('summaryCards');
    el.innerHTML = `<div class="summary-card">
        <div class="summary-icon"><i class="fas fa-layer-group"></i></div>
        <div><strong>Total Resources</strong><p>${resources.length}</p></div>
    </div>`;
}

function showAddResourceForm() {
    isEditMode = false;
    document.querySelector('form').reset();
    document.getElementById('addResourceForm').style.display = 'block';
}

function hideAddResourceForm() {
    document.getElementById('addResourceForm').style.display = 'none';
}

function editResource(id) {
    const r = resources.find(x => x.id === id);
    isEditMode = true;
    resourceId.value = r.id;
    resourceName.value = r.name;
    resourceType.value = r.type;
    capacity.value = r.capacity;
    location.value = r.location;
    description.value = r.description;
    addResourceForm.style.display = 'block';
}

async function handleResourceForm(e) {
    e.preventDefault();

    const data = {
        name: resourceName.value,
        type: resourceType.value,
        capacity: +capacity.value,
        location: location.value,
        description: description.value
    };

    const method = isEditMode ? 'PUT' : 'POST';
    const url = isEditMode ? `/api/resources/${resourceId.value}` : '/api/resources';

    await fetch(url, {
        method,
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify(data)
    });

    showNotification('Saved successfully', 'success');
    hideAddResourceForm();
    loadResources();
}

function showDeleteModal(id, name) {
    resourceToDelete = id;
    deleteModalBody.innerHTML = `Delete <strong>${name}</strong>?`;
    deleteModal.style.display = 'flex';
}

function closeDeleteModal() {
    deleteModal.style.display = 'none';
}

async function confirmDelete() {
    await fetch(`/api/resources/${resourceToDelete}`, { method: 'DELETE' });
    closeDeleteModal();
    showNotification('Deleted', 'success');
    loadResources();
}

function showNotification(msg, type) {
    const n = document.createElement('div');
    n.className = `notification ${type}`;
    n.textContent = msg;
    notificationContainer.appendChild(n);
    setTimeout(()=>n.classList.add('show'),50);
    setTimeout(()=>n.remove(),3000);
}
</script>

</body>
</html>
